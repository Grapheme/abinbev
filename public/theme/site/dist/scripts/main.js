$(document).ready(function(){function a(){var a=new google.maps.LatLngBounds,s={url:"../images/ico-marker.png"},i={mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!0,zoomControl:!0,scrollwheel:!1,disableDoubleClickZoom:!0,navigationControl:!0,disableDefaultUI:!1};t=new google.maps.Map(document.getElementById("google-map"),i),$.each(institutions,function(n,i){i.marker=new google.maps.Marker({position:new google.maps.LatLng(i.lat,i.lng),map:t,icon:s}),google.maps.event.addListener(i.marker,"click",function(){adress-window.setContent('<div class="adress-window">'+i.adress+"</div>"),adress-window.open(t,this)}),a.extend(i.marker.position)}),t.fitBounds(a),n()}$("fotorama").fotorama(),$("a.product").fancybox({width:643,height:435,autoSize:!1,afterShow:function(){$(".about-product").mCustomScrollbar()}}),$(".institutions-list").mCustomScrollbar(),$(".fix").hover(function(){$(".fix-2").addClass("smoke"),$(".fix-2.smoke").hover(function(){$(".responsibility-page-head").addClass("kek")})}),$.fn.smart_map=function(a){$(this).each(function(){function t(a){var t=a.pageX-r.offset().left,n=a.pageY-r.offset().top;if(c.find(".js-admin-dot").length)c.find(".js-admin-dot").css({left:t,top:n});else{var s={radius:$(".js-admin-map-radius").val(),posY:n,posX:t},i=d(0,s,!0);c.find(".js-map-block").append(i)}$(".js-admin-map-x").val(t),$(".js-admin-map-y").val(n)}function n(){var a=parseInt($(".js-admin-map-x").val()),t=parseInt($(".js-admin-map-y").val());c.find(".js-admin-dot").css({left:a,top:t})}function s(){{var a=parseInt($(".js-admin-map-x").val()),t=parseInt($(".js-admin-map-y").val());parseInt($(".js-admin-map-radius").val())}c.find(".js-admin-dot").remove();var n={radius:parseInt($(".js-admin-map-radius").val()),posY:t,posX:a},s=d(0,n,!0);c.find(".js-map-block").append(s)}function i(t){var n;n="<"==t?-1:1;var s=m+n;-1==s&&(s=a.length-1),s==a.length&&(s=0),e(s)}function e(t){var n=a[t],s=n.items,i=n.name,e=n.posX,o=n.posY,d="";$.each(s,function(a,t){d+="<li>"+t}),l.find(".js-desc-title").text(i),l.find(".js-desc-items").html(d),setTimeout(function(){l.find(".js-desc-items").customScrollbar()},1);var p=r.width()/4-e,c=r.height()/2-o,u=transform("translateX("+p+"px) translateY("+c+"px)");r.attr("style",u),$(".js-map-dot[data-id="+t+"]").addClass("active").siblings().removeClass("active"),l.show(),m=parseInt(t)}function o(){r.attr("style",transform("translateX(0px) translateY(0px)")),$(".js-map-dot").removeClass("active"),l.hide()}function d(a,t,n){11*t.radius;if(n)var s=" js-admin-dot";else var s="";var i='<a href="#" class="map-dot js-map-dot'+s+'" style="top: '+t.posY+"px; left: "+t.posX+'px;" data-id="'+a+'"></a>';return i}function p(t,n,s){var i="";$.each(a,function(a,t){var n=d(a,t,!0);i+=n}),r.html(i),l.hide(),$(window).width()<=768&&e(0)}var c=$(this),r=c.find(".js-map-block"),l=c.find(".js-map-desc"),m=!1;c.hasClass("js-admin-map")?($(document).on("click",".js-map-dot",function(){return!1}),$(document).on("click",".js-map-block",function(a){t(a)}),$(document).on("input",".js-admin-map-x, .js-admin-map-y",function(){n()}),$(document).on("change",".js-admin-map-radius",function(){s()})):($(document).on("click",".js-map-dot",function(){var a=$(this).attr("data-id");return e(a),!1}),$(document).on("click",".js-desc-close",function(){return o(),!1}),$(document).on("click",".js-map-control",function(){return i($(this).attr("data-direction")),!1})),p()})},$(".js-admin-map").smart_map([{posX:200,posY:200}]),$(".js-client-map").smart_map([{posX:200,posY:200}]);var t;google.maps.event.addDomListener(window,"load",a),$.each(institutions,function(a,t){$("#city").append('<option value="'+t.city+'">'+t.city+"</option>"),$("#cuisine").append('<option value="'+t.cuisine+'">'+t.cuisine+"</option>"),$("#type").append('<option value="'+t.type+'">'+t.type+"</option>"),$(".institutions-list .institutions").append('<li class="js-sort-item" data-index="'+a+'"><span data-value="'+t.city+'" class="city"></span><span data-value="'+t.name+'" class="name">'+t.name+'</span><span data-value="'+t.type+'" class="type">'+t.type+'</span><span data-value="'+t.cuisine+'" class="cuisine">'+t.cuisine+'</span><span data-value="'+t.adress+'" class="adress">'+t.adress+"</span></li>")});var n=function(){var a={};a.city=$("#city").val(),a.cuisine=$("#cuisine").val(),a.type=$("#type").val(),$(".js-sort-item").each(function(){var n=$(this),s=institutions[parseInt(n.attr("data-index"))],i=s.marker,e=!0;$.each(a,function(a,t){n.find('[data-value="'+t+'"]').length||(e=!1)}),e?(n.show(),i.setMap(t)):(n.hide(),i.setMap(null))})};$(".js-filter-select").on("change",function(){n()})});